# blog-2-epub

一个通用的博客文章抓取工具，可将指定博客的全站文章抓取下来，保存为 Markdown 文件，并打包成一个精美的 ePub 电子书，方便在 Kindle 等电子设备上离线阅读。

本项目最大的特点是利用了 Mozilla 的 `readability` 库，能够智能地识别并提取文章正文，极大地简化了添加新博客网站的配置过程。

## 重要声明 (Disclaimer)
本项目旨在提供一个技术示例，仅供个人学习和研究目的使用。

使用者在利用本工具抓取任何网站内容前，应首先阅读并遵守该网站的服务条款（Terms of Service）和 `robots.txt` 文件。所有通过本工具抓取的内容，其版权归原作者及相应网站所有。

对于因使用本工具而可能产生的任何直接或间接的法律后果，包括但不限于版权纠纷，项目作者概不负责。使用者需自行承担所有相关风险与责任。

## 主要功能

- **配置简单**：仅需提供博客的归档页和文章链接的选择器即可添加新目标。

- **智能解析**：自动提取文章的标题和正文，去除广告、导航栏等无关元素。

- **双重格式输出**：

    1. 将每篇文章保存为独立的 `.md` 文件，方便本地查阅和编辑。

    2. 将所有文章打包成一个带目录的 `.epub` 文件，优化阅读体验。

- **开箱即用**：已预先配置好 Paul Graham, Wait But Why, Naval 等知名博客。

## 安装依赖

在运行脚本前，请确保您已安装 Python，并使用 pip 安装所有必需的第三方库：
```bash
pip install requests beautifulsoup4 html2text ebooklib readability-lxml
```

## 如何使用

1. 将项目代码保存为 smart_scraper.py 文件。

2. 打开您的终端（命令行工具）。

3. 通过命令行参数指定您想抓取的网站名称来运行脚本。

**示例:**
```bash
# 抓取 Paul Graham 的博客
python smart_scraper.py "Paul Graham"

# 抓取 Wait But Why 的博客
python smart_scraper.py "Wait But Why"

```

4. 脚本运行后，会在当前目录下创建一个 `output` 文件夹。所有抓取的内容都将保存在这里，并按博客名称分子文件夹存放。

## 如何阅读 ePub 文件

生成的 `.epub` 文件是标准的电子书格式，您可以通过多种方式打开它：

- **桌面端:**

    - **macOS / Windows**: 使用 Calibre，它是一款功能强大的免费电子书管理软件。

    - **macOS**: 直接双击文件，使用系统自带的“图书 (Books)”应用打开。

- **移动端:**

    - **iOS / iPadOS**: 通过“文件”应用将 .epub 文件导入到系统自带的“图书 (Books)”应用中。

    - **Android**: 使用 Google Play Books, Lithium 或其他支持 ePub 格式的阅读 App。

- **在线阅读器:**

    - 如果您不想安装任何软件，可以直接使用在线阅读网站，例如 EpubReader，上传文件即可阅读。

## 如何添加新的博客

这是本工具最强大的功能之一。您只需简单两步即可添加对新博客的支持：

1. **分析目标网站**

    - 找到博客的**文章归档/列表页**（例如 https://example.com/archives）。

    - 在浏览器中打开该页面，右键点击任意一篇文章的标题，选择“检查”或“审查元素”来打开开发者工具。

    - 分析 HTML 结构，找到一个能够唯一定位到所有文章链接 `<a>` 标签的 **CSS 选择器**。

2. **更新脚本配置**

- 打开 `smart_scraper.py` 文件，找到顶部的 `SITES` 字典。

- 在字典中添加一个新的条目，包含新博客的配置信息。

**配置模板:**
```json
"博客名称": {
    "index_pages": ["归档页面的URL"],
    "base_url": "博客的主域名URL",
    "link_selector": "你在上一步找到的CSS选择器",
},

```

## 贡献与反馈

如果您在使用过程中遇到任何问题，或者对项目有任何改进建议，欢迎随时提出。